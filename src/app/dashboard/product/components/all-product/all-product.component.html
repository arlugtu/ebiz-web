<!-- BEGIN LOADER -->
<div id="load_screen" *ngIf="showLoader">
  <div class="loader">
    <div class="loader-content">
      <div class="spinner-grow align-self-center"></div>
    </div>
  </div>
</div>
<!--  END LOADER -->
<div class="layout-boxed layout-px-spacing">
  <h1 class="layout-top-spacing">Product</h1>
  <div class="row">
    <div class="col-12 text-end">
      <button type="button" class="btn btn-success" routerLink="./create">
        Add
      </button>
    </div>
  </div>
  <div class="row mt-2">
    <div class="col-12">
      <h6 id="allDataHeader" *ngIf="allData.length == 0"></h6>
      <div id="toggleAccordion" class="accordion">
        <div class="card" *ngFor="let data of allData">
          <div class="card-header">
            <section class="mb-0 mt-0">
              <div role="menu" class="collapsed d-flex align-items-center"
                  data-bs-toggle="collapse" data-bs-target="#defaultAccordionOne"
                  aria-expanded="false" aria-controls="defaultAccordionOne"
                  style="place-content: space-between;"
                  (click)="toggleAccordion(data.product_id)">
                {{data.product_name}}
                <div >
                  <button type="button" class="btn btn-sm btn-info"
                      (click)="$event.stopPropagation(); showModal(modalInventory, data);">
                    View Inventory
                  </button>
                  <button type="button" class="btn btn-sm btn-danger ms-1"
                      (click)="$event.stopPropagation(); deleteData(data.product_id);">
                    Delete
                  </button>
                </div>
              </div>
            </section>
          </div>
          <div id="{{data.product_id}}" class="collapse" aria-labelledby="..."
              data-bs-parent="#toggleAccordion">
            <div class="card-body">
              <div class="row">
                <div class="col-sm-6">
                  <small class="text-white">Category</small>
                  <p >{{data.category_name}}</p>
                </div>
                <div class="col-sm-6">
                  <small class="text-white">Subcategory</small>
                  <p >{{data.subcategory_name}}</p>
                </div>
                <div class="col-sm-6">
                  <small class="text-white">Product Name</small>
                  <p >{{data.product_name}}</p>
                </div>
                <div class="col-sm-6">
                  <small class="text-white">Product Description</small>
                  <p >{{data.description}}</p>
                </div>
                <div class="col-sm-6">
                  <small class="text-white">Price</small>
                  <p >{{data.price || 0}}</p>
                </div>
                <div class="col-sm-6">
                  <small class="text-white">Points</small>
                  <p >{{data.points || 0}}</p>
                </div>
                <div class="col-sm-6">
                  <small class="text-white">Inventory</small>
                  <p id="inventory-{{data.product_id}}">{{data.inventory || 0}}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div #modalInventory id="modalInventory" class="modal fade" tabindex="-1"
      role="dialog" aria-labelledby="modalInventory" aria-hidden="true"
      data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h6 >Inventory</h6>
          <button class="btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-12 text-end">
              <button type="button" class="btn btn-sm btn-warning"
                  (click)="fileUpload.click()">
                Upload
              </button>
              <input #fileUpload type="file" multiple="true"
                  (change)="uploadFiles($event)" hidden>
            </div>
          </div>
          <table class="table table-hover table-bordered mt-2">
            <thead >
              <tr >
                <th >File Name</th>
                <th >File Path</th>
                <th class="text-center">Actions</th>
              </tr>
            </thead>
            <tbody >
              <tr *ngFor="let data of inventories">
                <td >
                  {{data.file_name}}
                </td>
                <td >
                  {{data.file_path}}
                </td>
                <td class="text-center">
                  <button type="button" class="btn btn-sm btn-primary"
                      (click)="downloadFile(data.inventory_id)">
                    <i class="bi bi-download"></i>
                  </button>
                  <button type="button" class="btn btn-sm btn-danger ms-1"
                      (click)="deleteInventory(data.inventory_id)">
                    <i class="bi bi-trash"></i>
                  </button>
                </td>
              </tr>
              <tr *ngIf="inventories.length == 0">
                <td colspan="100">No available data</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
